#! /usr/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision - 12;
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/system.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_sys.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/vhdl_textio.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/v2005_math.vpi";
:vpi_module "/usr/lib/x86_64-linux-gnu/ivl/va_math.vpi";
S_0x62a50c0127e0 .scope module, "mnist_mlp_tb" "mnist_mlp_tb" 2 3;
 .timescale -9 -12;
v0x62a50c034020_0 .var "CLOCK_50", 0 0;
v0x62a50c0340e0_0 .var "KEY", 0 0;
v0x62a50c0341b0_0 .net "LEDR", 17 0, L_0x62a50c0346b0;  1 drivers
v0x62a50c0342b0_0 .var "SW", 0 0;
E_0x62a50c004af0 .event anyedge, v0x62a50c032fd0_0;
S_0x62a50c012970 .scope module, "uut" "mnist_mlp" 2 14, 3 3 0, S_0x62a50c0127e0;
 .timescale -9 -12;
    .port_info 0 /INPUT 1 "CLOCK_50";
    .port_info 1 /INPUT 1 "KEY";
    .port_info 2 /INPUT 1 "SW";
    .port_info 3 /OUTPUT 18 "LEDR";
P_0x62a50c016710 .param/l "S_ARGMAX" 1 3 30, C4<10>;
P_0x62a50c016750 .param/l "S_COMPUTE" 1 3 29, C4<01>;
P_0x62a50c016790 .param/l "S_DONE" 1 3 31, C4<11>;
P_0x62a50c0167d0 .param/l "S_IDLE" 1 3 28, C4<00>;
L_0x62a50c034520 .functor NOT 1, v0x62a50c0340e0_0, C4<0>, C4<0>, C4<0>;
L_0x62a50c0345c0 .functor BUFZ 1, v0x62a50c0342b0_0, C4<0>, C4<0>, C4<0>;
v0x62a50bff3860_0 .net "CLOCK_50", 0 0, v0x62a50c034020_0;  1 drivers
v0x62a50c032ef0_0 .net "KEY", 0 0, v0x62a50c0340e0_0;  1 drivers
v0x62a50c032fd0_0 .net "LEDR", 17 0, L_0x62a50c0346b0;  alias, 1 drivers
v0x62a50c0330c0_0 .net "SW", 0 0, v0x62a50c0342b0_0;  1 drivers
o0x7a2dffa89138 .functor BUFZ 13, C4<zzzzzzzzzzzzz>; HiZ drive
; Elide local net with no drivers, v0x62a50c0331a0_0 name=_ivl_17
v0x62a50c0332d0_0 .net *"_ivl_3", 3 0, v0x62a50c033ba0_0;  1 drivers
v0x62a50c0333b0_0 .net *"_ivl_7", 0 0, v0x62a50c0336c0_0;  1 drivers
v0x62a50c033490_0 .var "argmax_idx", 3 0;
v0x62a50c033570 .array/s "biases", 9 0, 15 0;
v0x62a50c0336c0_0 .var "done", 0 0;
v0x62a50c033780 .array "image", 783 0, 7 0;
v0x62a50c033840_0 .var/s "max_val", 33 0;
v0x62a50c033920_0 .var "neuron_idx", 3 0;
v0x62a50c033a00 .array/s "outputs", 9 0, 33 0;
v0x62a50c033ac0_0 .var "pixel_idx", 9 0;
v0x62a50c033ba0_0 .var "predicted_digit", 3 0;
v0x62a50c033c80_0 .net "reset", 0 0, L_0x62a50c034520;  1 drivers
v0x62a50c033d40_0 .net "start", 0 0, L_0x62a50c0345c0;  1 drivers
v0x62a50c033e00_0 .var "state", 1 0;
v0x62a50c033ee0 .array/s "weights", 7839 0, 15 0;
E_0x62a50c007bd0 .event posedge, v0x62a50c033c80_0, v0x62a50bff3860_0;
L_0x62a50c0346b0 .concat [ 4 13 1 0], v0x62a50c033ba0_0, o0x7a2dffa89138, v0x62a50c0336c0_0;
S_0x62a50bfcb490 .scope begin, "$ivl_for_loop0" "$ivl_for_loop0" 3 68, 3 68 0, S_0x62a50c012970;
 .timescale -9 -12;
v0x62a50bffcf80_0 .var/i "i", 31 0;
S_0x62a50c032c70 .scope begin, "$ivl_for_loop1" "$ivl_for_loop1" 3 79, 3 79 0, S_0x62a50c012970;
 .timescale -9 -12;
v0x62a50bff39b0_0 .var/i "i", 31 0;
    .scope S_0x62a50c012970;
T_0 ;
    %vpi_call 3 49 "$readmemh", "weights.hex", v0x62a50c033ee0 {0 0 0};
    %vpi_call 3 50 "$readmemh", "biases.hex", v0x62a50c033570 {0 0 0};
    %vpi_call 3 54 "$readmemh", "image.hex", v0x62a50c033780 {0 0 0};
    %end;
    .thread T_0;
    .scope S_0x62a50c012970;
T_1 ;
    %wait E_0x62a50c007bd0;
    %load/vec4 v0x62a50c033c80_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.0, 8;
    %pushi/vec4 0, 0, 2;
    %assign/vec4 v0x62a50c033e00_0, 0;
    %pushi/vec4 0, 0, 10;
    %assign/vec4 v0x62a50c033ac0_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v0x62a50c033920_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v0x62a50c033490_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v0x62a50c033ba0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x62a50c0336c0_0, 0;
    %pushi/vec4 2147483648, 0, 32;
    %concati/vec4 0, 0, 2;
    %assign/vec4 v0x62a50c033840_0, 0;
    %fork t_1, S_0x62a50bfcb490;
    %jmp t_0;
    .scope S_0x62a50bfcb490;
t_1 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x62a50bffcf80_0, 0, 32;
T_1.2 ;
    %load/vec4 v0x62a50bffcf80_0;
    %cmpi/s 10, 0, 32;
    %jmp/0xz T_1.3, 5;
    %pushi/vec4 0, 0, 34;
    %ix/getv/s 3, v0x62a50bffcf80_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v0x62a50c033a00, 0, 4;
    %load/vec4 v0x62a50bffcf80_0;
    %addi 1, 0, 32;
    %store/vec4 v0x62a50bffcf80_0, 0, 32;
    %jmp T_1.2;
T_1.3 ;
    %end;
    .scope S_0x62a50c012970;
t_0 %join;
    %jmp T_1.1;
T_1.0 ;
    %load/vec4 v0x62a50c033e00_0;
    %dup/vec4;
    %pushi/vec4 0, 0, 2;
    %cmp/u;
    %jmp/1 T_1.4, 6;
    %dup/vec4;
    %pushi/vec4 1, 0, 2;
    %cmp/u;
    %jmp/1 T_1.5, 6;
    %dup/vec4;
    %pushi/vec4 2, 0, 2;
    %cmp/u;
    %jmp/1 T_1.6, 6;
    %dup/vec4;
    %pushi/vec4 3, 0, 2;
    %cmp/u;
    %jmp/1 T_1.7, 6;
    %jmp T_1.8;
T_1.4 ;
    %load/vec4 v0x62a50c033d40_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.9, 8;
    %pushi/vec4 1, 0, 2;
    %assign/vec4 v0x62a50c033e00_0, 0;
    %pushi/vec4 0, 0, 10;
    %assign/vec4 v0x62a50c033ac0_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v0x62a50c033920_0, 0;
    %fork t_3, S_0x62a50c032c70;
    %jmp t_2;
    .scope S_0x62a50c032c70;
t_3 ;
    %pushi/vec4 0, 0, 32;
    %store/vec4 v0x62a50bff39b0_0, 0, 32;
T_1.11 ;
    %load/vec4 v0x62a50bff39b0_0;
    %cmpi/s 10, 0, 32;
    %jmp/0xz T_1.12, 5;
    %ix/getv/s 4, v0x62a50bff39b0_0;
    %load/vec4a v0x62a50c033570, 4;
    %pad/s 34;
    %ix/getv/s 3, v0x62a50bff39b0_0;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v0x62a50c033a00, 0, 4;
    %load/vec4 v0x62a50bff39b0_0;
    %addi 1, 0, 32;
    %store/vec4 v0x62a50bff39b0_0, 0, 32;
    %jmp T_1.11;
T_1.12 ;
    %end;
    .scope S_0x62a50c012970;
t_2 %join;
T_1.9 ;
    %jmp T_1.8;
T_1.5 ;
    %load/vec4 v0x62a50c033920_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v0x62a50c033a00, 4;
    %load/vec4 v0x62a50c033ac0_0;
    %pad/u 32;
    %muli 10, 0, 32;
    %load/vec4 v0x62a50c033920_0;
    %pad/u 32;
    %add;
    %ix/vec4 4;
    %load/vec4a v0x62a50c033ee0, 4;
    %pad/s 34;
    %pushi/vec4 0, 0, 8;
    %load/vec4 v0x62a50c033ac0_0;
    %pad/u 11;
    %ix/vec4 4;
    %load/vec4a v0x62a50c033780, 4;
    %concat/vec4; draw_concat_vec4
    %pad/s 34;
    %mul;
    %add;
    %load/vec4 v0x62a50c033920_0;
    %pad/u 5;
    %ix/vec4 3;
    %ix/load 4, 0, 0; Constant delay
    %assign/vec4/a/d v0x62a50c033a00, 0, 4;
    %load/vec4 v0x62a50c033ac0_0;
    %pad/u 32;
    %cmpi/e 783, 0, 32;
    %jmp/0xz  T_1.13, 4;
    %pushi/vec4 0, 0, 10;
    %assign/vec4 v0x62a50c033ac0_0, 0;
    %load/vec4 v0x62a50c033920_0;
    %pad/u 32;
    %cmpi/e 9, 0, 32;
    %jmp/0xz  T_1.15, 4;
    %pushi/vec4 2, 0, 2;
    %assign/vec4 v0x62a50c033e00_0, 0;
    %pushi/vec4 0, 0, 4;
    %assign/vec4 v0x62a50c033490_0, 0;
    %pushi/vec4 2147483648, 0, 32;
    %concati/vec4 0, 0, 2;
    %assign/vec4 v0x62a50c033840_0, 0;
    %jmp T_1.16;
T_1.15 ;
    %load/vec4 v0x62a50c033920_0;
    %addi 1, 0, 4;
    %assign/vec4 v0x62a50c033920_0, 0;
T_1.16 ;
    %jmp T_1.14;
T_1.13 ;
    %load/vec4 v0x62a50c033ac0_0;
    %addi 1, 0, 10;
    %assign/vec4 v0x62a50c033ac0_0, 0;
T_1.14 ;
    %jmp T_1.8;
T_1.6 ;
    %load/vec4 v0x62a50c033840_0;
    %load/vec4 v0x62a50c033490_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v0x62a50c033a00, 4;
    %cmp/s;
    %jmp/0xz  T_1.17, 5;
    %load/vec4 v0x62a50c033490_0;
    %pad/u 5;
    %ix/vec4 4;
    %load/vec4a v0x62a50c033a00, 4;
    %assign/vec4 v0x62a50c033840_0, 0;
    %load/vec4 v0x62a50c033490_0;
    %assign/vec4 v0x62a50c033ba0_0, 0;
T_1.17 ;
    %load/vec4 v0x62a50c033490_0;
    %pad/u 32;
    %cmpi/e 9, 0, 32;
    %jmp/0xz  T_1.19, 4;
    %pushi/vec4 3, 0, 2;
    %assign/vec4 v0x62a50c033e00_0, 0;
    %jmp T_1.20;
T_1.19 ;
    %load/vec4 v0x62a50c033490_0;
    %addi 1, 0, 4;
    %assign/vec4 v0x62a50c033490_0, 0;
T_1.20 ;
    %jmp T_1.8;
T_1.7 ;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v0x62a50c0336c0_0, 0;
    %load/vec4 v0x62a50c033d40_0;
    %nor/r;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.21, 8;
    %pushi/vec4 0, 0, 2;
    %assign/vec4 v0x62a50c033e00_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x62a50c0336c0_0, 0;
T_1.21 ;
    %jmp T_1.8;
T_1.8 ;
    %pop/vec4 1;
T_1.1 ;
    %jmp T_1;
    .thread T_1;
    .scope S_0x62a50c0127e0;
T_2 ;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x62a50c034020_0, 0, 1;
T_2.0 ;
    %delay 10000, 0;
    %load/vec4 v0x62a50c034020_0;
    %inv;
    %store/vec4 v0x62a50c034020_0, 0, 1;
    %jmp T_2.0;
    %end;
    .thread T_2;
    .scope S_0x62a50c0127e0;
T_3 ;
    %vpi_call 2 29 "$display", "Starting Testbench..." {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x62a50c0340e0_0, 0, 1;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x62a50c0342b0_0, 0, 1;
    %delay 20000, 0;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x62a50c0340e0_0, 0, 1;
    %vpi_call 2 36 "$display", "Reset released." {0 0 0};
    %delay 20000, 0;
    %vpi_call 2 41 "$display", "Flipping start switch ON." {0 0 0};
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x62a50c0342b0_0, 0, 1;
    %vpi_call 2 45 "$display", "Waiting for completion (LEDR[17] to go high)..." {0 0 0};
T_3.0 ;
    %load/vec4 v0x62a50c0341b0_0;
    %parti/s 1, 17, 6;
    %pushi/vec4 1, 0, 1;
    %cmp/e;
    %flag_get/vec4 4;
    %cmpi/ne 1, 0, 1;
    %jmp/0xz T_3.1, 6;
    %wait E_0x62a50c004af0;
    %jmp T_3.0;
T_3.1 ;
    %vpi_call 2 47 "$display", "Computation complete!" {0 0 0};
    %vpi_call 2 50 "$display", "Predicted digit on LEDR[3:0] is: %d", &PV<v0x62a50c0341b0_0, 0, 4> {0 0 0};
    %delay 20000, 0;
    %vpi_call 2 55 "$display", "Flipping start switch OFF." {0 0 0};
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x62a50c0342b0_0, 0, 1;
    %delay 50000, 0;
    %vpi_call 2 60 "$display", "Testbench finished." {0 0 0};
    %vpi_call 2 61 "$finish" {0 0 0};
    %end;
    .thread T_3;
    .scope S_0x62a50c0127e0;
T_4 ;
    %delay 200000000, 0;
    %vpi_call 2 67 "$display", "ERROR: Simulation timed out!" {0 0 0};
    %vpi_call 2 68 "$finish" {0 0 0};
    %end;
    .thread T_4;
# The file index is used to find the file name in the following table.
:file_names 4;
    "N/A";
    "<interactive>";
    "mnist_mlp_tb.v";
    "mnist_mlp.v";
